{% extends 'customers/base.html' %}

{% block content %}
<div class="container">
    <!-- Page Header -->
    <div class="card mb-4">
        <div class="card-header">
            <h1 class="text-center mb-0">Manage Inventory</h1>
        </div>
    </div>

    <!-- Inventory Summary -->
    <div class="total-inventory">
        <h3>Total Inventory Value</h3>
        <p>{{ total_value|default:"0.00" }} Rs</p>
    </div>

    <!-- Search Bar -->
    <div class="card mb-4">
        <div class="card-body">
            <form method="GET" action="{% url 'customers:manage_inventory' %}" class="d-flex">
                <input type="text" name="q" class="form-control me-2" placeholder="Search by item name or category..." value="{{ request.GET.q }}">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-search"></i> Search
                </button>
            </form>
        </div>
    </div>

    <!-- Add New Item Buttons -->
    <div class="row mb-4">
        <div class="col-md-4">
            <a href="{% url 'customers:add_product' %}" class="btn btn-success btn-lg w-100">
                <i class="fas fa-plus"></i> Add Product
            </a>
        </div>
        <div class="col-md-4">
            <a href="{% url 'customers:add_supplier' %}" class="btn btn-info btn-lg w-100">
                <i class="fas fa-plus"></i> Add Supplier
            </a>
        </div>
        <div class="col-md-4">
            <a href="{% url 'customers:add_inventory' %}" class="btn btn-warning btn-lg w-100">
                <i class="fas fa-plus"></i> Add Inventory
            </a>
        </div>
    </div>

    <!-- Inventory Table -->
    <div class="card mb-4">
        <div class="card-body">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Product</th>
                        <th scope="col">Supplier</th>
                        <th scope="col">Batch</th>
                        <th scope="col">Quantity</th>
                        <th scope="col">Purchase Price</th>
                        <th scope="col">Selling Price</th>
                        <th scope="col">Purchase Date</th>
                        <th scope="col">Expiry Date</th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in inventory %}
                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td>{{ item.product.name }}</td>
                        <td>{{ item.supplier.name }}</td>
                        <td>{{ item.batch_number }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>{{ item.purchase_price }} Rs</td>
                        <td>{{ item.selling_price }} Rs</td>
                        <td>{{ item.purchase_date|date:"Y-m-d" }}</td>
                        <td>{{ item.expiry_date|date:"Y-m-d" }}</td>
                        <td class="action-buttons">
                            <a href="{% url 'customers:edit_inventory' item.id %}" class="btn btn-sm btn-warning">
                                <i class="fas fa-edit"></i> Edit
                            </a>
                            <a href="{% url 'customers:delete_inventory' item.id %}" class="btn btn-sm btn-danger">
                                <i class="fas fa-trash"></i> Delete
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="10" class="text-center">No items found.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Custom JS for interactivity -->
<script>
document.querySelectorAll('.table-hover tbody tr').forEach(row => {
    row.addEventListener('mouseenter', () => {
        row.style.transform = 'scale(1.02)';
    });
    row.addEventListener('mouseleave', () => {
        row.style.transform = 'scale(1)';
    });
});
</script>
{% endblock %}